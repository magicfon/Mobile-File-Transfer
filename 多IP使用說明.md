# 📱 多IP檔案傳輸系統使用說明

## 🌟 新功能特色

### ✅ 原有功能
- 跨平台檔案傳輸 (Android/iPhone → Windows)
- QR Code快速連接
- 拖拽上傳、多檔案同時上傳
- 即時進度顯示

### 🆕 新增功能
- **多網路介面偵測**：自動偵測所有可用的IP位址
- **智慧選擇**：讓使用者選擇正確的網路介面
- **多IP QR Code視窗**：同時顯示所有可用IP的QR Code
- **更好的錯誤處理**：適用於複雜的網路環境

## 🚀 使用方式

### 1. 啟動程式
```bash
python app_improved.py
```

### 2. 選擇IP位址

程式會自動偵測所有網路介面，並顯示類似以下的選項：
```
============================================================
🌐 偵測到多個網路介面，請選擇要使用的IP位址：
============================================================
1. 192.168.1.100    # 主WiFi網路
2. 192.168.2.50     # WiFi延伸器
3. 192.168.56.1     # 虛擬網路卡

💡 提示：
   - 選擇與手機相同網段的IP位址
   - 如果不確定，可以逐一嘗試
   - 一般家用網路常見：192.168.1.x 或 192.168.0.x

請輸入選擇 (1-3) 或 'a' 顯示所有選項:
```

### 3. 選擇方式

#### 選項A：選擇單一IP
輸入數字 (例如: `1`)
- ✅ 確定知道正確的IP位址
- ✅ 想要簡潔的單一QR Code

#### 選項B：顯示所有IP
輸入 `a`
- ✅ 不確定哪個IP正確
- ✅ 想要一次看到所有選項

## 📱 手機連接方式

### 情況1：選擇了單一IP
1. 出現傳統的QR Code視窗
2. 手機掃描QR Code
3. 如果無法連接，重新啟動程式選擇其他IP

### 情況2：顯示所有IP選項
1. 出現多IP選擇視窗
2. 視窗中顯示所有可用IP的QR Code
3. 逐一嘗試掃描，直到找到可連接的IP

## 🔧 網路環境判斷

### 如何判斷手機和電腦在同一網段？

#### 方法1：檢查IP位址
- **電腦IP**：192.168.1.100
- **手機IP**：192.168.1.200
- ✅ **結果**：前三組數字相同，可以連接

#### 方法2：檢查連接的WiFi名稱
- 確保手機和電腦連接到相同的WiFi網路
- 注意：即使WiFi名稱相同，也可能在不同子網路

#### 方法3：測試連通性
在電腦命令提示字元輸入：
```cmd
ping 手機的IP位址
```

## 🏠 常見網路環境

### 環境A：簡單家用網路
```
路由器 (192.168.1.1)
├── 電腦: 192.168.1.100
└── 手機: 192.168.1.200
```
**解決方案**：選擇 192.168.1.100

### 環境B：有WiFi延伸器（不同子網路）
```
主路由器 (192.168.1.1)
├── 電腦: 192.168.1.100
└── 延伸器 (192.168.2.1)
    └── 手機: 192.168.2.200
```
**問題**：❌ 無法連接
**解決方案**：將延伸器設定為橋接模式

### 環境C：有WiFi延伸器（橋接模式）
```
主路由器 (192.168.1.1)
├── 電腦: 192.168.1.100
└── 延伸器（橋接模式）
    └── 手機: 192.168.1.200
```
**解決方案**：選擇 192.168.1.100

### 環境D：Mesh網路系統
```
Mesh系統 (192.168.1.1)
├── 節點1 - 電腦: 192.168.1.100
└── 節點2 - 手機: 192.168.1.200
```
**解決方案**：選擇 192.168.1.100

## 🛠️ 故障排除

### 問題1：偵測不到正確的IP
**原因**：系統可能遺漏某些網路介面
**解決方案**：
1. 手動檢查電腦IP：`ipconfig`
2. 如果發現遺漏的IP，可以修改程式碼

### 問題2：所有IP都無法連接
**可能原因**：
- 防火牆阻擋
- 路由器設定了客戶端隔離
- 手機和電腦不在同一網路

**解決方案**：
1. 檢查Windows防火牆設定
2. 檢查路由器的「客戶端隔離」設定
3. 確認手機和電腦連接到同一WiFi

### 問題3：QR Code無法掃描
**解決方案**：
- 點擊「複製」按鈕，手動在手機瀏覽器輸入網址
- 調整QR Code視窗大小

## 📊 程式改進點

### 與原版本的差異
| 功能 | 原版本 | 改進版本 |
|------|--------|----------|
| IP偵測 | 單一IP（預設路由） | 多個IP（所有介面） |
| 網路支援 | 簡單網路環境 | 複雜多WiFi環境 |
| 使用者選擇 | 無選擇 | 命令行 + GUI選擇 |
| 錯誤處理 | 基本 | 智慧過濾無效IP |
| QR Code | 單一 | 單一或多個選項 |

### 技術改進
- **多種IP獲取方法**：socket + 系統命令
- **IP有效性驗證**：過濾無效IP範圍
- **GUI增強**：滾動式多IP顯示
- **使用者體驗**：清晰的提示和說明

## 🎯 使用建議

1. **首次使用**：建議選擇 `a` 顯示所有選項，瞭解您的網路環境
2. **已知網路**：直接選擇已知正確的IP位址
3. **公司網路**：注意可能有多個虛擬網路卡，選擇主要的工作網路
4. **旅館WiFi**：通常只有一個有效IP，但可能有額外限制

這個改進版本完美解決了多WiFi分享器環境下的連接問題！ 🎉 